<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://clearsky.dev/favicon.ico><link rel=stylesheet href=/css/style.min.css><title>Rails doesn't save my added attribute</title></head><body><header id=banner><h2><a href=https://clearsky.dev/>ClearSky</a></h2><nav><ul></ul></nav></header><main id=content><article><header id=post-header><h1>Rails doesn't save my added attribute</h1><div><time>July 9, 2022</time></div></header><p>A long long time ago in 2014, before I started to work in a place ruled by the evil snake called &ldquo;python&rdquo;, I worked with a little framework called <a href=https://rubyonrails.org>Ruby on Rails</a>. It was a wonderful time. Rails was hip in those days. All the cool kids were doing it. What I liked most about rails was how little code was needed to achieve something.</p><p>There is a bit a learning curve with rails. Rails is magic. You don&rsquo;t need to understand exactly what is happening, but you do need to remember the right spells. The good thing is that once you get into the rails mindset, you start expecting things to work in a certain way. And 9 out of 10 times, it does!</p><p>Another philosophy that i like about rails is &ldquo;<strong>convention over configuration</strong>&rdquo;. For instance: lets say you have a table &ldquo;posts&rdquo;. What do you call the column that identifies a row? And the column that is the foreign key to the &ldquo;authors&rdquo; table? In most cases, it doesn&rsquo;t really matter. So rails decides for you: &ldquo;id&rdquo; and &ldquo;author_id&rdquo;. The rails ORM called ActiveRecord understands these column. Now you can do things like <code>my_post.author</code> and boom you&rsquo;ve followed that foreign key without ever naming it in your code. Ofcourse, of you really want to, there&rsquo;s a way to <a href=https://guides.rubyonrails.org/association_basics.html#options-for-belongs-to-foreign-key>change the name of the foreign key column</a></p><p>So rails was great in 2014. I hadn&rsquo;t used it or even looked at it since that time. The hype seems to have passed. The cool kids have all jumped on the nodejs/&ldquo;single page app&rdquo;-train. I seem to have missed that train. In fact, i never liked javascript or npm. So, when rails&rsquo; big boss <a href=https://world.hey.com/dhh/modern-web-apps-without-javascript-bundling-or-transpiling-a20f2755>posted a blog about a new rails version that steers clear from transpiling and bundling</a>, I was paying attention. When rails 7 came out in december 2021, I decided to take it for a spin.</p><blockquote><p>rails in 2022: less hype, same magic?</p></blockquote><p>It felt like coming home after a long trip: running <code>rails g scaffold post title:string content:text</code> and <code>rails s</code> and finding your crud functions ready and working. This is where a lot of &ldquo;rails tutorials&rdquo; stop. But a scaffold is not a building. It&rsquo;s a starting point. What happens when we want to add an attribute to our blog?</p><ul><li>First, we add a new migration to add a column to the table. Dont forget to <code>rails db:migrate</code></li><li>Next, we edit the _form partial to define an input field for the attribute</li><li>As i remember it, there was no step 3. Lets give it a whirl!</li></ul><p><strong>Wait, it doesn&rsquo;t error but it also doesn&rsquo;t save the new attribute?</strong></p><p>It turns out that in the last 8 years, someone found out that it isn&rsquo;t the greatest idea to let the user define arbitrary attributes in the controller update/create calls. So now you have to define which model attributes can be updated by the controller. They call it <a href=https://edgeapi.rubyonrails.org/classes/ActionController/StrongParameters.html>Strong parameters</a>. It looks like this:</p><pre tabindex=0><code>def blog_params
  params.require(:blog).permit(:title, :content)
end
</code></pre><p>So adding an attribute now requires this extra step in the controller. This is a process i do very often when developing apps. I guess it makes sense security wise to have this validation. For me though, it also means rails has lost some of its famous magic.</p><p>There&rsquo;s lots of other magic left though, and even some new magic that was added since 2014. I really like <a href=https://edgeguides.rubyonrails.org/active_storage_overview.html>active storage</a>.</p></article></main><footer id=footer></footer></body></html>